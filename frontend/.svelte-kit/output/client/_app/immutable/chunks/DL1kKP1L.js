var h=Object.defineProperty;var u=(a,t,e)=>t in a?h(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var o=(a,t,e)=>u(a,typeof t!="symbol"?t+"":t,e);import{_ as d}from"./C1FmrZbK.js";import{b as p}from"./Bt-Xh7oU.js";import{g as I}from"./_pMazo4M.js";const s=class s{constructor(){o(this,"axiosInstance",null);o(this,"initialized",!1)}static getInstance(){return s.instance||(s.instance=new s),s.instance}async initializeClient(){if(!(this.initialized||!p))try{const{default:t}=await d(async()=>{const{default:n}=await import("./DIycyeiE.js");return{default:n}},[],import.meta.url),e="https://tradesense-gateway-production.up.railway.app";this.axiosInstance=t.create({baseURL:e,timeout:3e4,headers:{"Content-Type":"application/json"}});const i=this.getStoredToken();i&&(this.axiosInstance.defaults.headers.common.Authorization=`Bearer ${i}`),this.setupInterceptors(),this.initialized=!0}catch(t){console.error("Failed to initialize API client:",t)}}setupInterceptors(){this.axiosInstance&&this.axiosInstance.interceptors.response.use(t=>t,async t=>{var n,c,l;((n=t.response)==null?void 0:n.status)===401&&(this.clearStoredToken(),await I("/login"));const e=(c=t.response)==null?void 0:c.data,i={message:(e==null?void 0:e.detail)||(e==null?void 0:e.message)||t.message||"An error occurred",status:((l=t.response)==null?void 0:l.status)||500,detail:e};return Promise.reject(i)})}getStoredToken(){try{return localStorage.getItem("authToken")}catch{return null}}clearStoredToken(){try{localStorage.removeItem("authToken")}catch{}}async get(t,e){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.get(t,{params:e})).data}async post(t,e,i){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.post(t,e,i)).data}async put(t,e){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.put(t,e)).data}async patch(t,e){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.patch(t,e)).data}async delete(t){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.delete(t)).data}setAuthToken(t){try{localStorage.setItem("authToken",t),this.axiosInstance&&(this.axiosInstance.defaults.headers.common.Authorization=`Bearer ${t}`)}catch{}}clearAuth(){this.clearStoredToken(),this.axiosInstance&&delete this.axiosInstance.defaults.headers.common.Authorization}getAuthToken(){return this.getStoredToken()}isAuthenticated(){return!!this.getStoredToken()}};o(s,"instance",null);let r=s;const g=r.getInstance();export{g as a};

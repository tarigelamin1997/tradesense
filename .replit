modules = ["python-3.12"]

[nix]
channel = "stable-24_05"
packages = [
  "glibcLocales",
  "libiconv",
  "libxcrypt",
  "openssl",
  "pkg-config",
  "libstdcxx",    # âœ… Needed to fix the libstdc++.so.6 error
]

[deployment]
run = [
  "sh",
  "-c",
  "streamlit run app.py --server.port=5000 --server.address=0.0.0.0",
]

[[ports]]
localPort = 5000
externalPort = 80

[workflows]
runButton = "Run"

[[workflows.workflow]]
name = "Run"
author = 43683701
mode = "sequential"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "pkill -f streamlit || true"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "sleep 1"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "streamlit run app.py --server.port=5000 --server.address=0.0.0.0 --server.enableWebsocketCompression=true --server.enableXsrfProtection=false --server.fileWatcherType=none"

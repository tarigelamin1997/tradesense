var m=Object.defineProperty;var g=(s,t,e)=>t in s?m(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var o=(s,t,e)=>g(s,typeof t!="symbol"?t+"":t,e);import{a as k}from"./Dq7h7Pqt.js";import{g as A}from"./BlAxCd93.js";const d="https://tradesense-gateway-production.up.railway.app";console.log("API Base URL:",d);class y{constructor(){o(this,"client");o(this,"token",null);this.client=k.create({baseURL:d,timeout:3e4,headers:{"Content-Type":"application/json"}}),this.token=localStorage.getItem("authToken"),this.setupInterceptors()}setupInterceptors(){this.client.interceptors.request.use(t=>(console.log("Making request to:",t.url),console.log("Base URL:",t.baseURL),console.log("Full URL:",t.baseURL+t.url),this.token&&(t.headers.Authorization=`Bearer ${this.token}`),t),t=>Promise.reject(t)),this.client.interceptors.response.use(t=>t,async t=>{var n,r,i,c,l,u,p,h;console.error("API Error:",{url:(n=t.config)==null?void 0:n.url,method:(r=t.config)==null?void 0:r.method,status:(i=t.response)==null?void 0:i.status,statusText:(c=t.response)==null?void 0:c.statusText,data:(l=t.response)==null?void 0:l.data,message:t.message}),((u=t.response)==null?void 0:u.status)===401&&(this.clearAuth(),A("/login"));const e=(p=t.response)==null?void 0:p.data,a={message:(e==null?void 0:e.detail)||(e==null?void 0:e.message)||t.message||"An error occurred",status:((h=t.response)==null?void 0:h.status)||500,detail:e};return Promise.reject(a)})}setAuthToken(t){this.token=t,localStorage.setItem("authToken",t)}clearAuth(){this.token=null,localStorage.removeItem("authToken")}isAuthenticated(){return!!this.token}async get(t,e){return(await this.client.get(t,{params:e})).data}async post(t,e,a){return(await this.client.post(t,e,a)).data}async put(t,e){return(await this.client.put(t,e)).data}async patch(t,e){return(await this.client.patch(t,e)).data}async delete(t){return(await this.client.delete(t)).data}}const R=new y;export{R as a};

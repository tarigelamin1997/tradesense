var h=Object.defineProperty;var u=(s,t,e)=>t in s?h(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var n=(s,t,e)=>u(s,typeof t!="symbol"?t+"":t,e);import{_ as d}from"./C1FmrZbK.js";import{b as p}from"./Bt-Xh7oU.js";import{g as I}from"./D-G9JMcs.js";const a=class a{constructor(){n(this,"axiosInstance",null);n(this,"initialized",!1)}static getInstance(){return a.instance||(a.instance=new a),a.instance}async initializeClient(){if(!(this.initialized||!p))try{const{default:t}=await d(async()=>{const{default:i}=await import("./DIycyeiE.js");return{default:i}},[],import.meta.url);this.axiosInstance=t.create({baseURL:"https://tradesense-gateway-production.up.railway.app",timeout:3e4,headers:{"Content-Type":"application/json"}});const e=this.getStoredToken();e&&(this.axiosInstance.defaults.headers.common.Authorization=`Bearer ${e}`),this.setupInterceptors(),this.initialized=!0}catch(t){console.error("Failed to initialize API client:",t)}}setupInterceptors(){this.axiosInstance&&this.axiosInstance.interceptors.response.use(t=>t,async t=>{var o,c,l;((o=t.response)==null?void 0:o.status)===401&&(this.clearStoredToken(),await I("/login"));const e=(c=t.response)==null?void 0:c.data,i={message:(e==null?void 0:e.detail)||(e==null?void 0:e.message)||t.message||"An error occurred",status:((l=t.response)==null?void 0:l.status)||500,detail:e};return Promise.reject(i)})}getStoredToken(){try{return localStorage.getItem("authToken")}catch{return null}}clearStoredToken(){try{localStorage.removeItem("authToken")}catch{}}async get(t,e){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.get(t,{params:e})).data}async post(t,e,i){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.post(t,e,i)).data}async put(t,e){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.put(t,e)).data}async patch(t,e){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.patch(t,e)).data}async delete(t){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.delete(t)).data}setAuthToken(t){try{localStorage.setItem("authToken",t),this.axiosInstance&&(this.axiosInstance.defaults.headers.common.Authorization=`Bearer ${t}`)}catch{}}clearAuth(){this.clearStoredToken(),this.axiosInstance&&delete this.axiosInstance.defaults.headers.common.Authorization}getAuthToken(){return this.getStoredToken()}isAuthenticated(){return!!this.getStoredToken()}};n(a,"instance",null);let r=a;const g=r.getInstance();export{g as a};

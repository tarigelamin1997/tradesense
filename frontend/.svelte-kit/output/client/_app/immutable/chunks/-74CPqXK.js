var h=Object.defineProperty;var u=(n,t,e)=>t in n?h(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var o=(n,t,e)=>u(n,typeof t!="symbol"?t+"":t,e);import{_ as d}from"./C1FmrZbK.js";import{b as p}from"./Bt-Xh7oU.js";import{g as I}from"./CMDLyNOv.js";const s=class s{constructor(){o(this,"axiosInstance",null);o(this,"initialized",!1)}static getInstance(){return s.instance||(s.instance=new s),s.instance}async initializeClient(){if(!(this.initialized||!p))try{const{default:t}=await d(async()=>{const{default:a}=await import("./BVKiFqNl.js");return{default:a}},[],import.meta.url),e="https://tradesense-backend-production.up.railway.app";this.axiosInstance=t.create({baseURL:e,timeout:3e4,headers:{"Content-Type":"application/json"}});const i=this.getStoredToken();i&&(this.axiosInstance.defaults.headers.common.Authorization=`Bearer ${i}`),this.setupInterceptors(),this.initialized=!0}catch(t){console.error("Failed to initialize API client:",t)}}setupInterceptors(){this.axiosInstance&&this.axiosInstance.interceptors.response.use(t=>t,async t=>{var a,r,l;((a=t.response)==null?void 0:a.status)===401&&(this.clearStoredToken(),await I("/login"));const e=(r=t.response)==null?void 0:r.data,i={message:(e==null?void 0:e.detail)||(e==null?void 0:e.message)||t.message||"An error occurred",status:((l=t.response)==null?void 0:l.status)||500,detail:e};return Promise.reject(i)})}getStoredToken(){try{return localStorage.getItem("authToken")}catch{return null}}clearStoredToken(){try{localStorage.removeItem("authToken")}catch{}}async get(t,e){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.get(t,{params:e})).data}async post(t,e,i){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");const a={...i,headers:{...this.axiosInstance.defaults.headers.common,...i==null?void 0:i.headers}};return(await this.axiosInstance.post(t,e,a)).data}async put(t,e){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.put(t,e)).data}async patch(t,e){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.patch(t,e)).data}async delete(t){if(await this.initializeClient(),!this.axiosInstance)throw new Error("API client not initialized");return(await this.axiosInstance.delete(t)).data}setAuthToken(t){try{localStorage.setItem("authToken",t),this.axiosInstance&&(this.axiosInstance.defaults.headers.common.Authorization=`Bearer ${t}`)}catch{}}clearAuth(){this.clearStoredToken(),this.axiosInstance&&delete this.axiosInstance.defaults.headers.common.Authorization}getAuthToken(){return this.getStoredToken()}isAuthenticated(){return!!this.getStoredToken()}};o(s,"instance",null);let c=s;const z=c.getInstance();export{z as a};

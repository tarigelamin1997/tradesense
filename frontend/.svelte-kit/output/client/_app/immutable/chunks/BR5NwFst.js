import{S as Y,i as $,s as ee,d as b,N as te,t as y,a as x,J as B,I as F,D as C,Z as G,f as S,h as w,G as q,k as D,l as j,o as U,q as O,r as I,n as V,y as N,z,A,p as L,B as J,v as R,e as le,H as ne,m as se,L as P}from"./Lbc7qOuA.js";import{g as oe}from"./D0QH3NT1.js";import{e as Z}from"./BPb2qfkA.js";import"./IHki7fMi.js";import{a as re}from"./B8MKr4Yk.js";import{F as ie}from"./BVoy4-16.js";import{T as ae}from"./C6q2ekXb.js";import{F as ce}from"./CEJcwZ0r.js";import{C as fe}from"./BGdJAnOw.js";import{D as ue}from"./-mP7Un7Q.js";const{window:me}=oe;function K(a,t,e){const n=a.slice();return n[13]=t[e],n}function de(a){let t,e,n,l;return t=new ue({props:{size:18}}),{c(){J(t.$$.fragment),e=I(),n=R(a[0])},l(o){A(t.$$.fragment,o),e=U(o),n=L(o,a[0])},m(o,f){z(t,o,f),S(o,e,f),S(o,n,f),l=!0},p(o,f){(!l||f&1)&&le(n,o[0])},i(o){l||(x(t.$$.fragment,o),l=!0)},o(o){y(t.$$.fragment,o),l=!1},d(o){o&&(b(e),b(n)),N(t,o)}}}function _e(a){let t,e;return{c(){t=O("div"),e=R(`
			Exporting...`),this.h()},l(n){t=D(n,"DIV",{class:!0}),j(t).forEach(b),e=L(n,`
			Exporting...`),this.h()},h(){C(t,"class","spinner svelte-869mkx")},m(n,l){S(n,t,l),S(n,e,l)},p:V,i:V,o:V,d(n){n&&(b(t),b(e))}}}function pe(a){let t,e,n;return t=new fe({props:{size:18}}),{c(){J(t.$$.fragment),e=R(`
			Exported!`)},l(l){A(t.$$.fragment,l),e=L(l,`
			Exported!`)},m(l,o){z(t,l,o),S(l,e,o),n=!0},p:V,i(l){n||(x(t.$$.fragment,l),n=!0)},o(l){y(t.$$.fragment,l),n=!1},d(l){l&&b(e),N(t,l)}}}function Q(a){let t,e,n="Export Format",l,o,f=Z(a[5]),s=[];for(let i=0;i<f.length;i+=1)s[i]=W(K(a,f,i));const h=i=>y(s[i],1,1,()=>{s[i]=null});return{c(){t=O("div"),e=O("div"),e.textContent=n,l=I();for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){t=D(i,"DIV",{class:!0});var u=j(t);e=D(u,"DIV",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-tq8mhr"&&(e.textContent=n),l=U(u);for(let r=0;r<s.length;r+=1)s[r].l(u);u.forEach(b),this.h()},h(){C(e,"class","menu-header svelte-869mkx"),C(t,"class","export-menu svelte-869mkx")},m(i,u){S(i,t,u),w(t,e),w(t,l);for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(t,null);o=!0},p(i,u){if(u&96){f=Z(i[5]);let r;for(r=0;r<f.length;r+=1){const k=K(i,f,r);s[r]?(s[r].p(k,u),x(s[r],1)):(s[r]=W(k),s[r].c(),x(s[r],1),s[r].m(t,null))}for(B(),r=f.length;r<s.length;r+=1)h(r);F()}},i(i){if(!o){for(let u=0;u<f.length;u+=1)x(s[u]);o=!0}},o(i){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)y(s[u]);o=!1},d(i){i&&b(t),ne(s,i)}}}function W(a){let t,e,n,l,o,f=a[13].label+"",s,h,i,u=a[13].description+"",r,k,d,m,_;var c=a[13].icon;function E(p,g){return{props:{size:20}}}c&&(e=P(c,E()));function T(){return a[12](a[13])}return{c(){t=O("button"),e&&J(e.$$.fragment),n=I(),l=O("div"),o=O("div"),s=R(f),h=I(),i=O("div"),r=R(u),k=I(),this.h()},l(p){t=D(p,"BUTTON",{class:!0});var g=j(t);e&&A(e.$$.fragment,g),n=U(g),l=D(g,"DIV",{class:!0});var v=j(l);o=D(v,"DIV",{class:!0});var H=j(o);s=L(H,f),H.forEach(b),h=U(v),i=D(v,"DIV",{class:!0});var M=j(i);r=L(M,u),M.forEach(b),v.forEach(b),k=U(g),g.forEach(b),this.h()},h(){C(o,"class","format-label svelte-869mkx"),C(i,"class","format-description svelte-869mkx"),C(l,"class","format-info svelte-869mkx"),C(t,"class","format-option svelte-869mkx")},m(p,g){S(p,t,g),e&&z(e,t,null),w(t,n),w(t,l),w(l,o),w(o,s),w(l,h),w(l,i),w(i,r),w(t,k),d=!0,m||(_=q(t,"click",T),m=!0)},p(p,g){if(a=p,c!==(c=a[13].icon)){if(e){B();const v=e;y(v.$$.fragment,1,0,()=>{N(v,1)}),F()}c?(e=P(c,E()),J(e.$$.fragment),x(e.$$.fragment,1),z(e,t,n)):e=null}},i(p){d||(e&&x(e.$$.fragment,p),d=!0)},o(p){e&&y(e.$$.fragment,p),d=!1},d(p){p&&b(t),e&&N(e),m=!1,_()}}}function he(a){let t,e,n,l,o,f,s,h,i;const u=[pe,_e,de],r=[];function k(m,_){return m[4]?0:m[3]?1:2}n=k(a),l=r[n]=u[n](a);let d=a[2]&&!a[3]&&Q(a);return{c(){t=O("div"),e=O("button"),l.c(),f=I(),d&&d.c(),this.h()},l(m){t=D(m,"DIV",{class:!0});var _=j(t);e=D(_,"BUTTON",{class:!0});var c=j(e);l.l(c),c.forEach(b),f=U(_),d&&d.l(_),_.forEach(b),this.h()},h(){C(e,"class",o="export-button "+a[1]+" svelte-869mkx"),e.disabled=a[3],G(e,"success",a[4]),C(t,"class","export-dropdown svelte-869mkx")},m(m,_){S(m,t,_),w(t,e),r[n].m(e,null),w(t,f),d&&d.m(t,null),s=!0,h||(i=[q(me,"click",a[7]),q(e,"click",a[11])],h=!0)},p(m,[_]){let c=n;n=k(m),n===c?r[n].p(m,_):(B(),y(r[c],1,1,()=>{r[c]=null}),F(),l=r[n],l?l.p(m,_):(l=r[n]=u[n](m),l.c()),x(l,1),l.m(e,null)),(!s||_&2&&o!==(o="export-button "+m[1]+" svelte-869mkx"))&&C(e,"class",o),(!s||_&8)&&(e.disabled=m[3]),(!s||_&18)&&G(e,"success",m[4]),m[2]&&!m[3]?d?(d.p(m,_),_&12&&x(d,1)):(d=Q(m),d.c(),x(d,1),d.m(t,null)):d&&(B(),y(d,1,1,()=>{d=null}),F())},i(m){s||(x(l),x(d),s=!0)},o(m){y(l),y(d),s=!1},d(m){m&&b(t),r[n].d(),d&&d.d(),h=!1,te(i)}}}function X(a){if(a.length===0)return"";const t=Object.keys(a[0]),e=t.join(","),n=a.map(l=>t.map(o=>{const f=l[o];return typeof f=="string"&&(f.includes(",")||f.includes('"'))?`"${f.replace(/"/g,'""')}"`:f??""}).join(","));return[e,...n].join(`
`)}function be(a,t,e){let{endpoint:n}=t,{filename:l}=t,{buttonText:o="Export"}=t,{buttonClass:f=""}=t,{data:s=[]}=t,h=!1,i=!1,u=!1;const r=[{id:"csv",label:"CSV",icon:ie,description:"Comma-separated values"},{id:"excel",label:"Excel",icon:ae,description:"Microsoft Excel format"},{id:"json",label:"JSON",icon:ce,description:"JavaScript Object Notation"}];async function k(c){e(3,i=!0),e(4,u=!1);try{if(n){const E=await re.get(n,{params:{format:c},responseType:"blob"}),T=window.URL.createObjectURL(new Blob([E])),p=document.createElement("a");p.href=T,p.setAttribute("download",`${l}_${new Date().toISOString().split("T")[0]}.${c}`),document.body.appendChild(p),p.click(),p.remove(),window.URL.revokeObjectURL(T)}else if(s.length>0){let E,T;switch(c){case"csv":E=X(s),T="text/csv";break;case"json":E=JSON.stringify(s,null,2),T="application/json";break;case"excel":E=X(s),T="text/csv",c="csv";break;default:throw new Error("Unsupported format")}const p=new Blob([E],{type:T}),g=window.URL.createObjectURL(p),v=document.createElement("a");v.href=g,v.setAttribute("download",`${l}_${new Date().toISOString().split("T")[0]}.${c}`),document.body.appendChild(v),v.click(),v.remove(),window.URL.revokeObjectURL(g)}e(4,u=!0),setTimeout(()=>{e(4,u=!1),e(2,h=!1)},2e3)}catch{alert("Export failed. Please try again.")}finally{e(3,i=!1)}}function d(c){h&&!c.target.closest(".export-dropdown")&&e(2,h=!1)}const m=()=>e(2,h=!h),_=c=>k(c.id);return a.$$set=c=>{"endpoint"in c&&e(8,n=c.endpoint),"filename"in c&&e(9,l=c.filename),"buttonText"in c&&e(0,o=c.buttonText),"buttonClass"in c&&e(1,f=c.buttonClass),"data"in c&&e(10,s=c.data)},[o,f,h,i,u,r,k,d,n,l,s,m,_]}class Oe extends Y{constructor(t){super(),$(this,t,be,he,ee,{endpoint:8,filename:9,buttonText:0,buttonClass:1,data:10})}}export{Oe as D};

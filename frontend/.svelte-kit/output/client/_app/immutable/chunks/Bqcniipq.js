import{_ as p}from"./C1FmrZbK.js";import{g as m}from"./5fvPJk70.js";const d=()=>"https://tradesense-gateway-production.up.railway.app";let n=null;async function r(){if(!n){const{default:t}=await p(async()=>{const{default:e}=await import("./DIycyeiE.js");return{default:e}},[],import.meta.url),a=t.create({baseURL:d(),timeout:3e4,headers:{"Content-Type":"application/json"}}),o=localStorage.getItem("authToken");o&&(a.defaults.headers.common.Authorization=`Bearer ${o}`),a.interceptors.request.use(e=>(console.log("Making request to:",e.url),e),e=>Promise.reject(e)),a.interceptors.response.use(e=>e,async e=>{var i,c,l;console.error("API Error:",e.message),((i=e.response)==null?void 0:i.status)===401&&(localStorage.removeItem("authToken"),m("/login"));const s=(c=e.response)==null?void 0:c.data,u={message:(s==null?void 0:s.detail)||(s==null?void 0:s.message)||e.message||"An error occurred",status:((l=e.response)==null?void 0:l.status)||500,detail:s};return Promise.reject(u)}),n=a}return n}const w={async get(t,a){return(await(await r()).get(t,{params:a})).data},async post(t,a,o){return(await(await r()).post(t,a,o)).data},async put(t,a){return(await(await r()).put(t,a)).data},async patch(t,a){return(await(await r()).patch(t,a)).data},async delete(t){return(await(await r()).delete(t)).data},setAuthToken(t){localStorage.setItem("authToken",t),n&&(n.defaults.headers.common.Authorization=`Bearer ${t}`)},clearAuth(){localStorage.removeItem("authToken"),n&&delete n.defaults.headers.common.Authorization},getAuthToken(){return localStorage.getItem("authToken")},isAuthenticated(){return!!localStorage.getItem("authToken")}};export{w as a};
